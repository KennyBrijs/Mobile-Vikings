// Generated by CoffeeScript 1.3.3
(function() {
  var addMarker, createMap, isValidEmail, scrollTo, showEmailError;

  $(function() {
    var map;
    if (localStorage.email != null) {
      $("input#email").val(localStorage.email);
    }
    $('[href^="#"]').click(scrollTo);
    map = createMap();
    return addMarker(map);
  });

  createMap = function() {
    var map;
    map = L.map('map').setView([50.94958, 5.34657], 10);
    L.tileLayer('http://{s}.tile.cloudmade.com/744d221a8986462c8970d7087063bd59/997/256/{z}/{x}/{y}.png', {
      attribution: 'Map &copy Cloudmade',
      maxZoom: 18
    }).addTo(map);
    return map;
  };

  addMarker = function(map) {
    var marker;
    marker = L.marker([50.94958, 5.34657]).addTo(map);
    return marker;
  };

  scrollTo = function() {
    var destination, elementClicked;
    elementClicked = $(this).attr("href");
    destination = $(elementClicked).offset().top;
    $("html:not(:animated),body:not(:animated)").animate({
      scrollTop: destination - 20
    }, 500);
    return false;
  };

  isValidEmail = function(email) {
    var emailPattern;
    emailPattern = /^([\w.-]+)@([\w.-]+)\.([a-zA-Z.]{2,6})$/i;
    if (email.match(emailPattern)) {
      return true;
    } else {
      return false;
    }
  };

  showEmailError = function(message) {
    $('label[for="email"]').append('<small class="invalid" style="display: none">' + message + '</small>');
    return $('small.invalid').slideDown('slow', function() {
      return $('label[for="email"]').css('animation', 'shake 1s');
    });
  };

  window.processNewsletterForm = function(form) {
    var email, noErrorMessage;
    email = form.elements['email'].value;
    if (isValidEmail(email)) {
      if (typeof Storage !== "undefined" && Storage !== null) {
        localStorage.email = email;
      }
      return true;
    } else {
      if ($('label[for="email"] small.invalid').length === 0) {
        noErrorMessage = true;
      }
      if (noErrorMessage) {
        showEmailError("Dit email adres is niet geldig");
      }
      return false;
    }
  };

}).call(this);
